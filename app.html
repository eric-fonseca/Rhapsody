<!DOCTYPE html> 
<html> 
<head> 
	<title>Rhapsody</title> 

    <style type="text/css">
        /*input[type="range"] {
           transform: rotate(270deg);
        }*/
        #name{
            clear: both;
        }
        #playButton{
            background-color: #8a3b93;
            color: white;
            border-radius: 20px;
            cursor: pointer;
            width: 85px;
            height: 20px;
            padding: 3px;
            text-align: center;
            clear: both;
        }
        .trackContainer{
            width: 300px;
            text-align: center;
            float: left;
            margin: 5px;
        }
        .trackName{
            background-color: #ed3286;
            padding: 1px 0;
            cursor: pointer;
        }
        .trackName h3{
            color: white;
            margin: 5px 0px;
        }
        .trackSliders{
            background-color: #ffd3e7;
            padding: 5px;
        }
    </style>
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
	<script type="text/javascript" src="js/sb-1.4.1.js"></script>

    <script type="text/javascript">

    // call 'setupSpacebrew' function on pageload
		$(window).on("load", setupSpacebrew);

		// Spacebrew Variables/Objects
		var sb, values = {}, rhcpTracks = ["drums1", "drums2", "drums3", "guitar", "rhythm", "vocals"];

		// called on pageload
		function setupSpacebrew (){
			console.log("Setting up spacebrew connection");
			sb = new Spacebrew.Client();
			sb.name("Rhapsody");
			sb.description("Web->Processing");
            
			// configure the publication and subscription feeds
            for(var i = 0; i < rhcpTracks.length; i++){
                sb.addPublish(rhcpTracks[i] + "Gain", "range", "0");
            }
            sb.addPublish("playButton", "boolean", "false");
            
			// override Spacebrew events - this is how you catch events coming from Spacebrew
			sb.onOpen = onOpen;
			// connect to spacbrew
			sb.connect();
            setupUI();
		};

		// called when Spacebrew connection is established
		function onOpen() {
			$("#name").html("Connected as <strong>" + sb.name() + "</strong>.");
		}

		// called on init
		function setupUI() {
			console.log("Setting up the UI listeners");
			// when the slider state changes it sends a message to spacebrew
			$(".slider").on("input", function(e) {
				if (values[e.target.id] != e.target.value) {
					sb.send(e.target.id, "range", e.target.value);
					values[e.target.id] = e.target.value;
				}
			});
            $("#playButton").on("mousedown", function(e) {
				e.preventDefault();
	      	    console.log("[playButton] button has been pressed"); 
	            sb.send("playButton", "boolean", "true");
			});
            
            $(".trackName").on("click", function(){
                $(this).next().slideToggle(); 
            });
		}

    </script>

</head> 
<body>
    
    <div class="trackContainer">
        <div class="trackName"><h3>Drums 1</h3></div>
        <div class="trackSliders" style="display: none;">
            <input type="range" class="slider" id="drums1Gain" value="0" min="-50" max="50"/>
            <input type="range" class="slider" id="drums1Delay" value="0" min="-50" max="50"/><br>
            <input type="range" class="slider" id="drums1Balance" value="0" min="-50" max="50"/>
            <input type="range" class="slider" id="drums1Pitch" value="0" min="-50" max="50"/>
        </div>
    </div>
    
    <div class="trackContainer">
        <div class="trackName"><h3>Drums 2</h3></div>
        <div class="trackSliders" style="display: none;">
            <input type="range" class="slider" id="drums2Gain" value="0" min="-50" max="50"/>
            <input type="range" class="slider" id="drums2Delay" value="0" min="-50" max="50"/><br>
            <input type="range" class="slider" id="drums2Balance" value="0" min="-50" max="50"/>
            <input type="range" class="slider" id="drums2Pitch" value="0" min="-50" max="50"/>
        </div>
    </div>
    
    <div class="trackContainer">
        <div class="trackName"><h3>Drums 3</h3></div>
        <div class="trackSliders" style="display: none;">
            <input type="range" class="slider" id="drums3Gain" value="0" min="-50" max="50"/>
            <input type="range" class="slider" id="drums3Delay" value="0" min="-50" max="50"/><br>
            <input type="range" class="slider" id="drums3Balance" value="0" min="-50" max="50"/>
            <input type="range" class="slider" id="drums3Pitch" value="0" min="-50" max="50"/>
        </div>
    </div>
    
    <div class="trackContainer">
        <div class="trackName"><h3>Guitar</h3></div>
        <div class="trackSliders" style="display: none;">
            <input type="range" class="slider" id="guitarGain" value="0" min="-50" max="50"/>
            <input type="range" class="slider" id="guitarDelay" value="0" min="-50" max="50"/><br>
            <input type="range" class="slider" id="guitarBalance" value="0" min="-50" max="50"/>
            <input type="range" class="slider" id="guitarPitch" value="0" min="-50" max="50"/>
        </div>
    </div>
    
    <div class="trackContainer">
        <div class="trackName"><h3>Rhythm</h3></div>
        <div class="trackSliders" style="display: none;">
            <input type="range" class="slider" id="rhythmGain" value="0" min="-50" max="50"/>
            <input type="range" class="slider" id="rhythmDelay" value="0" min="-50" max="50"/><br>
            <input type="range" class="slider" id="rhythmBalance" value="0" min="-50" max="50"/>
            <input type="range" class="slider" id="rhythmPitch" value="0" min="-50" max="50"/>
        </div>
    </div>
    
    <div class="trackContainer">
        <div class="trackName"><h3>Vocals</h3></div>
        <div class="trackSliders" style="display: none;">
            <input type="range" class="slider" id="vocalsGain" value="0" min="-50" max="50"/>
            <input type="range" class="slider" id="vocalsDelay" value="0" min="-50" max="50"/><br>
            <input type="range" class="slider" id="vocalsBalance" value="0" min="-50" max="50"/>
            <input type="range" class="slider" id="vocalsPitch" value="0" min="-50" max="50"/>
        </div>
    </div>
    
    <div id="playButton">Play Song</div>
    <div id="name">Trying to connect</div>
</body>
</html>
